CREATE TABLE TB_BOARD
(
    BBS_ID NUMBER,
    POST_ID NUMBER,
    PARENT_IDX NUMBER,
    TITLE VARCHAR2(100) NOT NULL,
    CONTENTS VARCHAR2(4000) NOT NULL,
    HIT_CNT NUMBER NOT NULL,
    DEL_GB VARCHAR2(1) DEFAULT 'N' NOT NULL,
    CREA_DTM DATE DEFAULT SYSDATE NOT NULL,
    CREA_ID VARCHAR2(30) NOT NULL,
    PRIMARY KEY(BBS_ID,POST_ID)
);
  
COMMENT ON TABLE TB_BOARD IS '게시판';
COMMENT ON COLUMN TB_BOARD.BBS_ID IS '게시판 목록';
COMMENT ON COLUMN TB_BOARD.POST_ID IS '글 목록';
COMMENT ON COLUMN TB_BOARD.PARENT_IDX IS '부모글 인덱스';
COMMENT ON COLUMN TB_BOARD.TITLE IS '제목';
COMMENT ON COLUMN TB_BOARD.CONTENTS IS '내용';
COMMENT ON COLUMN TB_BOARD.HIT_CNT IS '조회수';
COMMENT ON COLUMN TB_BOARD.DEL_GB IS '삭제구분';
COMMENT ON COLUMN TB_BOARD.CREA_DTM IS '생성일자';
COMMENT ON COLUMN TB_BOARD.CREA_ID IS '생성자 ID';

CREATE SEQUENCE SEQ_TB_BOARD_POST_ID
START WITH 1
INCREMENT BY 1
NOMAXVALUE
NOCACHE;

CREATE TABLE TB_FILE
(
  IDX   NUMBER,
  BBS_ID NUMBER NOT NULL,
  POST_ID NUMBER NOT NULL,
  PARENT_IDX NUMBER,
  ORIGINAL_FILE_NAME VARCHAR2(260 BYTE) NOT NULL,
  STORED_FILE_NAME VARCHAR2(36 BYTE) NOT NULL,
  FILE_SIZE NUMBER,
  CREA_DTM  DATE DEFAULT SYSDATE NOT NULL,
  CREA_ID   VARCHAR2(30 BYTE) NOT NULL,
  DEL_GB    VARCHAR2(1 BYTE) DEFAULT 'N' NOT NULL,
  PRIMARY KEY (IDX)
);

COMMENT ON TABLE TB_FILE IS '첨부파일';
COMMENT ON COLUMN TB_FILE.IDX IS '인덱스';
COMMENT ON COLUMN TB_FILE.BBS_ID IS '게시판 목록';
COMMENT ON COLUMN TB_FILE.POST_ID IS '글 목록';
COMMENT ON COLUMN TB_FILE.PARENT_IDX IS '부모글 인덱스';
COMMENT ON COLUMN TB_FILE.ORIGINAL_FILE_NAME IS '원본 파일 이름';
COMMENT ON COLUMN TB_FILE.STORED_FILE_NAME IS '파일이름';
COMMENT ON COLUMN TB_FILE.FILE_SIZE IS '파일크기';
COMMENT ON COLUMN TB_FILE.DEL_GB IS '삭제구분';
COMMENT ON COLUMN TB_FILE.CREA_DTM IS '생성일자';
COMMENT ON COLUMN TB_FILE.CREA_ID IS '생성자 ID';

CREATE SEQUENCE SEQ_TB_FILE_IDX
  START WITH 1
  INCREMENT BY 1
  NOMAXVALUE
  NOCACHE;



CREATE TABLE TB_USER(
IDX NUMBER,
LOGIN_ID VARCHAR2(20),
PASS VARCHAR2(20),
NAME VARCHAR2(20) PRIMARY KEY,
DEL_GB VARCHAR2(1) DEFAULT 'N' NOT NULL,
CREA_DTM DATE DEFAULT SYSDATE NOT NULL
);

COMMENT ON TABLE TB_USER IS '유저';
COMMENT ON COLUMN TB_USER.IDX IS '인덱스';
COMMENT ON COLUMN TB_USER.LOGIN_ID IS '로그인아이디';
COMMENT ON COLUMN TB_USER.PASS IS '비밀번호';
COMMENT ON COLUMN TB_USER.NAME IS '닉네임';
COMMENT ON COLUMN TB_USER.DEL_GB IS '탈퇴여부';
COMMENT ON COLUMN TB_USER.CREA_DTM IS '가입 날자';


CREATE SEQUENCE SEQ_TB_USER_IDX
  START WITH 1
  INCREMENT BY 1
  NOMAXVALUE
  NOCACHE;


CREATE TABLE TB_BBS
(
    BBS_ID NUMBER PRIMARY KEY,
    BBS_NM VARCHAR(20)
)

COMMENT ON TABLE TB_BBS IS '게시판 목록';
COMMENT ON COLUMN TB_BBS.BBS_ID IS '게시판 번호';
COMMENT ON COLUMN TB_BBS.BBS_NM IS '테스트게시판';

ALTER TABLE TB_BOARD ADD CONSTRAINT FK_CREA_ID
FOREIGN KEY(CREA_ID) REFERENCES TB_USER(NAME)

ALTER TABLE TB_FILE ADD CONSTRAINT FK_BBS_POST
FOREIGN KEY(BBS_ID,POST_ID) REFERENCES TB_BBS(BBS_ID,POST_ID)

ALTER TABLE TB_BOARD ADD CONSTRAINT FK_BBS
FOREIGN KEY(BBS_ID) REFERENCES TB_BBS(BBS_ID)
